function t(t,s=document){return s.getElementsByClassName(t)}function s(t,s,i){for(let e=0,h=t.length;e<h;e++)s.call(i,t[e],e)}function i(t,s,i,e){t.addEventListener(s,i,e)}function e(t,s,i,e){t.removeEventListener(s,i,e)}function h(t,s){return t.getAttribute(s)}function n(t,s,i){t.setAttribute(s,i)}const a={css3easing:"linear",delayBeforeStart:1e3,direction:"left",duplicated:!1,duration:5e3,gap:20,pauseOnHover:!1,recalcResize:!1,speed:0,startVisible:!1};let r=0;export default class{constructor(s,e){if(void 0===s)throw new Error("el cannot be undefined");if("string"==typeof s)throw new Error("el cannot be just a selector");if(null===s)throw new Error("el cannot be null");e={...a,...e},this.t=3;for(const t in a){let i=h(s,`data-${a[t]}`);null!==i&&""!==i&&("true"!==i&&"false"!==i||(i=Boolean(i)),e[t]=i)}e.speed&&(e.duration=parseInt(s.clientWidth)/e.speed*1e3),e.gap=e.duplicated?parseInt(e.gap):0,s.innerHTML=`<div class="js-marquee">${s.innerHTML}</div>`;const n=t("js-marquee",s)[0];n.style.marginRight=`${e.gap}px`,n.style.willChange="transform",n.style.float="left",e.duplicated&&s.appendChild(n.cloneNode(!0)),s.innerHTML=`<div style="width:100000px" class="js-marquee-wrapper">${s.innerHTML}</div>`;const o=t("js-marquee-wrapper",s)[0],u="up"===e.direction||"down"===e.direction;this.i=o,this.h=u,this.o=e.duration,this.u=e,this.l();const l=`marqueeAnimation-${Math.floor(1e7*Math.random())}`,p=this.p(l,e.duration/1e3,e.delayBeforeStart/1e3,"infinite");this.m=l,this.$=p,e.duplicated?(u?e.startVisible?this.i.style.transform="translateY(0px)":this.i.style.transform=`translateY(${"up"===e.direction?this.v:-1*(2*this.g-e.gap)}px)`:e.startVisible?this.i.style.transform="translateX(0px)":this.i.style.transform=`translateX(${"left"===e.direction?this.I:-1*(2*this.q-e.gap)}px)`,e.startVisible||(this.t=1)):e.startVisible?this.t=2:u?this.j():this.S(),this.X=s,i(this.X,"pause",this.pause.bind(this)),i(this.X,"resume",this.resume.bind(this)),e.pauseOnHover&&(i(this.X,"mouseover",this.pause.bind(this)),i(this.X,"mouseout",this.resume.bind(this))),this.Y=()=>{this._(u),this.X.dispatchEvent(new CustomEvent("finished"))},this.C=r,r++,this._(u),e.recalcResize&&i(window,"resize",this.B.bind(this))}p(t="",s=0,i=0,e=""){return`${t} ${s}s ${i}s ${e} ${this.u.css3easing}`}_(e=!1){const h=this.u;if(h.duplicated){if(1===this.t){let t=h.duration;t=e?"up"===h.direction?t+this.v/(this.g/t):2*t:"left"===h.direction?t+this.I/(this.q/t):2*t,this.$=this.p(this.m,t/1e3,h.delayBeforeStart/1e3)}else 2===this.t&&(this.m=`${this.m}0`,this.$=this.p(this.m,h.duration/1e3,0,"infinite"));this.t++}let a="";e?h.duplicated?(this.t>2&&(this.i.style.transform=`translateY(${"up"===h.direction?0:-1*this.g}px)`),a=`translateY(${"up"===h.direction?-1*this.g:0}px)`):h.startVisible?2===this.t?(this.$=this.p(this.m,h.duration/1e3,h.delayBeforeStart/1e3),a=`translateY(${"up"===h.direction?-1*this.g:this.v}px)`,this.t++):3===this.t&&(this.m=`${this.m}0`,this.$=this.p(this.m,this.H/1e3,0,"infinite"),this.j()):(this.j(),a=`translateY(${"up"===h.direction?-1*this.i.clientHeight:this.v}px)`):h.duplicated?(this.t>2&&(this.i.style.transform=`translateX(${"left"===h.direction?0:-1*this.q}px)`),a=`translateX(${"left"===h.direction?-1*this.q:0}px)`):h.startVisible?2===this.t?(this.$=this.p(this.m,h.duration/1e3,h.delayBeforeStart/1e3),a=`translateX(${"left"===h.direction?-1*this.q:this.I}px)`,this.t++):3===this.t&&(this.m=`${this.m}0`,this.$=this.p(this.m,h.duration/1e3,0,"infinite"),this.S()):(this.S(),a=`translateX(${"left"===h.direction?-1*this.q:this.v}px)`),this.X.dispatchEvent(new CustomEvent("beforeStarting")),this.i.style.animation=this.$;const r=`@keyframes ${this.m} {\n        100% {\n          transform: ${a};\n        }\n      }`,o=function(t,s=document){return s.querySelectorAll(t)}("style",this.i);if(o.length)o[o.length-1].innerHTML=r;else if(t(`marq-wrap-style-${this.C}`).length)t(`marq-wrap-style-${this.C}`)[0].innerHTML=r;else{const t=document.createElement("style");!function(t,...i){function e(t,...s){s.forEach((s=>{t.classList.add(s)}))}void 0===t.length?e(t,...i):s(t,(t=>{e(t,...i)}))}(t,`marq-wrap-style-${this.C}`),t.innerHTML=r,function(t,s=document){return s.querySelector(t)}("head").appendChild(t)}i(this.i,"animationiteration",this.M.bind(this),{once:!0}),i(this.i,"animationend",this.Y.bind(this),{once:!0}),this.R="running",n(this.X,"data-runningStatus","resumed")}M(){this.X.dispatchEvent(new CustomEvent("finished"))}j(){this.i.style.transform=`translateY(${"up"===this.u.direction?this.v:-1*this.g}px)`}S(){this.i.style.transform=`translateX(${"left"===this.u.direction?this.I:-1*this.q}px)`}l(){const i=this.X,e=this.u;if(this.h){const h=i.clientHeight;this.v=h,function(t,s){t.removeAttribute(s)}(this.i,"style"),i.style.clientHeight=`${h}px`;const n=t("js-marquee",i),a=n.length-1;s(n,((t,s)=>{t.style.float="none",t.style.marginRight="0px",e.duplicated&&s===a?t.style.marginBottom="0px":t.style.marginBottom=`${e.gap}px`}));const r=parseInt(n[0].clientHeight+e.gap);this.g=r,e.startVisible&&!e.duplicated?(this.H=(r+h)/parseInt(h)*this.o,e.duration=r/parseInt(h)*this.o):e.duration=r/parseInt(h)/parseInt(h)*this.o}else{const s=parseInt(t("js-marquee",i)[0].clientWidth+e.gap),h=i.clientWidth;this.I=h,this.q=s,e.startVisible&&!e.duplicated?(this.H=(s+h)/parseInt(h)*this.o,e.duration=s/parseInt(h)*this.o):e.duration=(s+parseInt(h))/parseInt(h)*this.o}e.duplicated&&(e.duration=e.duration/2)}B(){this.l(),this.t=2,this.Y()}pause(){this.i.style.animationPlayState="paused",this.R="paused",n(this.X,"data-runningStatus","paused"),this.X.dispatchEvent(new CustomEvent("paused"))}resume(){this.i.style.animationPlayState="running",this.R="running",n(this.X,"data-runningStatus","resumed"),this.X.dispatchEvent(new CustomEvent("resumed"))}toggle(){"paused"===this.R?this.resume():"running"===this.R&&this.pause()}V(){e(this.X,"pause",this.pause.bind(this)),e(this.X,"resume",this.resume.bind(this)),this.u.pauseOnHover&&(e(this.X,"mouseover",this.pause.bind(this)),e(this.X,"mouseout",this.resume.bind(this))),e(this.i,"animationiteration",this.M.bind(this),{once:!0}),e(this.i,"animationend",this.Y.bind(this),{once:!0}),this.u.recalcResize&&e(window,"resize",this.B.bind(this))}}
