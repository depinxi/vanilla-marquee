function t(t,i=document){return i.getElementsByClassName(t)}function i(t,i,e){for(let s=0,n=t.length;s<n;s++)i.call(e,t[s],s)}function e(t,i,e,s){t.addEventListener(i,e,s)}function s(t,i,e,s){t.removeEventListener(i,e,s)}function n(t,i){return t.getAttribute(i)}function a(t,i,e){t.setAttribute(i,e)}const r={css3easing:"linear",delayBeforeStart:1e3,direction:"left",duplicated:!1,duration:5e3,easing:"linear",gap:20,pauseOnHover:!1,speed:0,startVisible:!1};export default class{constructor(s,a){if(void 0===s)throw new Error("el cannot be undefined");if("string"==typeof s)throw new Error("el cannot be just a selector");if(null===s)throw new Error("el cannot be null");a={...r,...a},this._loopCount=3;for(const t in r){let i=n(s,`data-${r[t]}`);null!==i&&""!==i&&("true"!==i&&"false"!==i||(i=Boolean(i)),a[t]=i)}a.speed&&(a.duration=parseInt(s.clientWidth)/a.speed*1e3),a.gap=a.duplicated?parseInt(a.gap):0,s.innerHTML=`<div class="js-marquee">${s.innerHTML}</div>`;const o=t("js-marquee",s)[0];o.style.marginRight=`${a.gap}px`,o.style.float="left",a.duplicated&&s.appendChild(o.cloneNode(!0)),s.innerHTML=`<div style="width:100000px" class="js-marquee-wrapper">${s.innerHTML}</div>`;const h=t("js-marquee-wrapper",s)[0],l="up"===a.direction||"down"===a.direction;if(this._marqWrap=h,l){const e=s.clientHeight;this._contHeight=e,function(t,i){t.removeAttribute(i)}(h,"style"),s.style.clientHeight=`${e}px`;const n=t("js-marquee",s),r=n.length-1;i(n,((t,i)=>{t.style.float="none",t.style.marginRight="0px",a.duplicated&&i===r?t.style.marginBottom="0px":t.style.marginBottom=`${a.gap}px`}));const o=parseInt(n[0].clientHeight+a.gap);this._elHeight=el_elHeight,a.startVisible&&!a.duplicated?(this._completeDuration=(o+e)/parseInt(e)*a.duration,a.duration=o/parseInt(e)*a.duration):a.duration=o/parseInt(e)/parseInt(e)*a.duration}else{const i=parseInt(t("js-marquee",s)[0].clientWidth+a.gap),e=s.clientWidth;this._contWidth=e,this._elWidth=i,a.startVisible&&!a.duplicated?(this._completeDuration=(i+e)/parseInt(e)*a.duration,a.duration=i/parseInt(e)*a.duration):a.duration=(i+parseInt(e))/parseInt(e)*a.duration}a.duplicated&&(a.duration=a.duration/2),this._opts=a;const u="marqueeAnimation-"+Math.floor(1e7*Math.random()),d=`${u} ${a.duration/1e3}s ${a.delayBeforeStart/1e3}s infinite ${a.css3easing}`;this._animName=u,this._animStr=d,a.duplicated?(l?a.startVisible?this._marqWrap.style.transform="translateY(0px)":this._marqWrap.style.transform=`translateY(${"up"===a.direction?this._contHeight:-1*(2*this._elHeight-a.gap)}px)`:a.startVisible?this._marqWrap.style.transform="translateX(0px)":this._marqWrap.style.transform=`translateX(${"left"===a.direction?this._contWidth:-1*(2*this._elWidth-a.gap)}px)`,a.startVisible||(this._loopCount=1)):a.startVisible?this._loopCount=2:l?this._repositionVert():this._repositionHor(),this.el=s,e(this.el,"pause",this.pause.bind(this)),e(this.el,"resume",this.resume.bind(this)),a.pauseOnHover&&(e(this.el,"mouseover",this.pause.bind(this)),e(this.el,"mouseout",this.resume.bind(this))),this._animEnd=()=>{this._animate(l),this.el.dispatchEvent(new CustomEvent("finished"))},this._animate(l)}_animate(s=!1){const n=this._opts;if(n.duplicated){if(1===this._loopCount){let t=n.duration;t=s?"up"===n.direction?t+this._contHeight/(this._elHeight/t):2*t:"left"===n.direction?t+this._contWidth/(this._elWidth/t):2*t,this._animStr=`${this._animName} ${t/1e3}s ${n.delayBeforeStart/1e3}s ${n.css3easing}`}else 2===this._loopCount&&(this._animName=`${this._animName}0`,this._animStr=`${this._animName} ${n.duration/1e3}s 0s infinite ${n.css3easing}`);this._loopCount++}let r="";s?n.duplicated?(this._loopCount>2&&(this._marqWrap.style.transform=`translateY(${"up"===n.direction?0:-1*this._elHeight}px)`),r=`translateY(${"up"===n.direction?-1*this._elHeight:0}px)`):n.startVisible?2===this._loopCount?(this._animStr=`${this._animName} ${n.duration/1e3}s ${n.delayBeforeStart/1e3}s ${n.css3easing}`,r=`translateY(${"up"===n.direction?-1*this._elHeight:this._contHeight}px)`,this._loopCount++):3===this._loopCount&&(this._animName=`${this._animName}0`,this._animStr=`${this._animName} ${this._completeDuration/1e3}s 0s infinite ${n.css3easing}`,this._repositionVert()):(this._repositionVert(),r=`translateY(${"up"===n.direction?-1*this._marqWrap.clientHeight:this._contHeight}px)`):n.duplicated?(this._loopCount>2&&(this._marqWrap.style.transform=`translateX(${"left"===n.direction?0:-1*this._elWidth}px)`),r=`translateX(${"left"===n.direction?-1*this._elWidth:0}px)`):n.startVisible?2===this._loopCount?(this._animStr=`${this._animName} ${n.duration/1e3}s ${n.delayBeforeStart/1e3}s ${n.css3easing}`,r=`translateX(${"left"===n.direction?-1*this._elWidth:this._contWidth}px)`,this._loopCount++):3===this._loopCount&&(this._animName=`${this._animName}0`,this._animStr=`${this._animName} ${n.duration/1e3}s 0s infinite ${n.css3easing}`,this._repositionHor()):(this._repositionHor(),r=`translateX(${"left"===n.direction?-1*this._elWidth:this._contHeight}px)`),this.el.dispatchEvent(new CustomEvent("beforeStarting")),this._marqWrap.style.animation=this._animStr;const o=`@keyframes ${this._animName} {\n      100% {\n        transform: ${r};\n      }\n    }`,h=function(t,i=document){return i.querySelectorAll(t)}("style",this._marqWrap);if(h.length)h[h.length-1].innerHTML=o;else if(t("marq-wrap-style").length)t("marq-wrap-style")[0].innerHTML=o;else{const t=document.createElement("style");!function(t,...e){function s(t,...i){i.forEach((i=>{t.classList.add(i)}))}void 0===t.length?s(t,...e):i(t,(t=>{s(t,...e)}))}(t,"marq-wrap-style"),t.innerHTML=o,function(t,i=document){return i.querySelector(t)}("head").appendChild(t)}e(this._marqWrap,"animationiteration",this._animIter.bind(this),{once:!0}),e(this._marqWrap,"animationend",this._animEnd.bind(this),{once:!0}),this._status,a(this.el,"data-runningStatus","resumed")}_animIter(){this.el.dispatchEvent(new CustomEvent("finished"))}_repositionVert(){this._marqWrap.style.transform=`translateY(${"up"===this._opts.direction?this._contHeight:-1*this._elHeight}px)`}_repositionHor(){this._marqWrap.style.transform=`translateX(${"left"===this._opts.direction?this._contWidth:-1*this._elWidth}px)`}pause(){this._marqWrap.style.animationPlayState="paused",this._status="paused",a(this.el,"data-runningStatus","paused"),this.el.dispatchEvent(new CustomEvent("paused"))}resume(){this._marqWrap.style.animationPlayState="running",this._status="running",a(this.el,"data-runningStatus","resumed"),this.el.dispatchEvent(new CustomEvent("resumed"))}toggle(){"paused"===this._status?this.resume():"running"===this._status&&this.pause()}destroy(){s(this.el,"pause",this.pause.bind(this)),s(this.el,"resume",this.resume.bind(this)),this._opts.pauseOnHover&&(s(this.el,"mouseover",this.pause.bind(this)),s(this.el,"mouseout",this.resume.bind(this))),s(this._marqWrap,"animationiteration",this._animIter.bind(this),{once:!0}),s(this._marqWrap,"animationend",this._animEnd.bind(this),{once:!0})}}
