function t(t,i=document){return i.getElementsByClassName(t)}function i(t,i,e,s){t.addEventListener(i,e,s)}function e(t,i,e,s){t.removeEventListener(i,e,s)}function s(t,i){return t.getAttribute(i)}const n={allowCss3Support:!0,css3easing:"linear",delayBeforeStart:1e3,direction:"left",duplicated:!1,duration:5e3,easing:"linear",gap:20,pauseOnCycle:!1,pauseOnHover:!1,speed:0,startVisible:!1};export default class{constructor(e,a){if(void 0===e)throw new Error("el cannot be undefined");if(null===e)throw new Error("el cannot be null");a={...a,...n},this._loopCount=3;for(const t in n){let i=s(e,`data-${n[t]}`);null!==i&&""!==i&&("true"!==i&&"false"!==i||(i=Boolean(i)),a[t]=i)}a.speed&&(a.duration=parseInt(e.clientWidth)/a.speed*1e3),a.gap=a.duplicated?parseInt(a.gap):0,e.innerHTML=`<div class="js-marquee">${e.innerHTML}</div>`;const r=t("js-marquee",e)[0];r.style.marginRight=`${a.gap}px`,r.style.float="left",a.duplicated&&e.appendChild(r.cloneNode(!0)),e.innerHTML=`<div style="width:100000px" class="js-marquee-wrapper">${e.innerHTML}</div>`;const o=t("js-marquee-wrapper",e)[0],l="up"===a.direction||"down"===a.direction;if(this._marqWrap=o,l){const i=e.clientHeight;this._contHeight=i,function(t,i){t.removeAttribute(i)}(o,"style"),e.style.clientHeight=`${i}px`;const s=t("js-marquee",e),n=s.length-1;!function(t,i,e){for(let s=0,n=t.length;s<n;s++)i.call(e,t[s],s)}(s,((t,i)=>{t.style.float="none",t.style.marginRight="0px",a.duplicated&&i===n?t.style.marginBottom="0px":t.style.marginBottom=`${a.gap}px`}));const r=parseInt(s[0].clientHeight+a.gap);this._elHeight=el_elHeight,a.startVisible&&!a.duplicated?(this._completeDuration=(r+i)/parseInt(i)*a.duration,a.duration=r/parseInt(i)*a.duration):a.duration=r/parseInt(i)/parseInt(i)*a.duration}else{const i=parseInt(t("js-marquee",e)[0].clientWidth+a.gap),s=e.clientWidth;this._contWidth=s,this._elWidth=i,a.startVisible&&!a.duplicated?(this._completeDuration=(i+s)/parseInt(s)*a.duration,a.duration=i/parseInt(s)*a.duration):a.duration=i/parseInt(s)/parseInt(s)*a.duration}a.duplicated&&(a.duration=a.duration/2),this._opts=a;let h="";if(a.allowCss3Support){const t="marqueeAnimation-"+Math.floor(1e7*Math.random());h=`${t} ${a.duration/1e3}s ${a.delayBeforeStart/1e3}s infinite ${a.css3easing}`,this._animName=t}this._animStr=h,a.duplicated?(l?a.startVisible?o.style.transfrom="translateY(0px)":o.style.transfrom=`translateY(${"up"===a.direction?this._contHeight:-1*(2*this._elHeight-a.gap)}px)`:a.startVisible?o.style.transfrom="translateC(0px)":o.style.transfrom=`translateY(${"left"===a.direction?this._contWidth:-1*(2*this._elWidth-a.gap)}px)`,a.startVisible||(this._loopCount=1)):a.startVisible?this._loopCount=2:l?this._repositionVert():this._repositionHor(),this.el=e,a.pauseOnHover&&(i(this.el,"mouseover",this.pause().bind(this)),i(this.el,"mouseout",this.resume().bind(this))),this._animEnd=()=>{this._animate(l),this.el.dispatchEvent(new CustomEvent("finished"))},a.allowCss3Support?this._animate(l):this._startAnimationWithDelay()}_animate(t=!1){const e=this._opts;if(e.duplicated){if(1===this._loopCount){let i=e.duration;i=t?"up"===e.direction?e.direction+this._contHeight/(this._elHeight/e.direction):2*e.direction:"left"===e.direction?e.direction+this._contWidth/(this._elWidth/e.direction):2*e.direction,this._animStr=`${this._animName} ${i/1e3}s ${e.delayBeforeStart/1e3}s ${e.css3easing}`}else 2===this._loopCount&&(this._animStr=`${animationName} ${this._completeDuration/1e3}s ${e.delayBeforeStart/1e3}s infinite ${e.css3easing}`);this._loopCount++}let s="";t?e.duplicated?(this._loopCount>2&&(this._marqWrap.style.transfrom=`translateY(${"up"===e.direction?0:-1*this._elHeight}px)`),s=`translateY(${"up"===e.direction?-1*this._elHeight:0}px)`):e.startVisible?2===this._loopCount?(this._animStr=`${animationName} ${e.duration/1e3}s ${e.delayBeforeStart/1e3}s ${e.css3easing}`,s=`translateX(${"left"===e.direction?-1*this._elWidth:this._contWidth}px)`,this._loopCount++):3===this._loopCount&&(this._animStr=`${animationName} ${this._completeDuration/1e3}s 0s infinite ${e.css3easing}`,this._repositionVert()):(this._repositionVert(),s=`translateY(${"up"===e.direction?-1*this._marqWrap.clientHeight:this._contHeight}px)`):e.duplicated?(this._loopCount>2&&(this._marqWrap.style.transfrom=`translateX(${"left"===e.direction?0:-1*this._elWidth}px)`),s=`translateX(${"left"===e.direction?-1*this._elWidth:0}px)`):e.startVisible?2===this._loopCount?(this._animStr=`${animationName} ${e.duration/1e3}s ${e.delayBeforeStart/1e3}s ${e.css3easing}`,s=`translateY(${"up"===e.direction?-1*this._elHeight:this._contHeight}px)`,this._loopCount++):3===this._loopCount&&(this._animStr=`${animationName} ${e.duration/1e3}s 0s infinite ${e.css3easing}`,this._repositionHor()):(this._repositionHor(),s=`translateY(${"left"===e.direction?-1*this._elWidth:this._contHeight}px)`),this.el.dispatchEvent(new CustomEvent("beforeStarting")),this._marqWrap.style.animation=this._animStr;const n=`@${this._animName} {\n      100% {\n        transform: ${s};\n      }\n    }`,a=function(t,i=document){return i.querySelectorAll(t)}("style",this._marqWrap);if(a.length)a[a.length-1].innerHTML=n;else{const t=document.createElement("style");style.innerHTML=n,query("head").appendChild(t)}i(this._marqWrap,"animationiteration",this._animIter.bind(this),{once:!0}),i(this._marqWrap,"animationend",this._animEnd.bind(this),{once:!0}),setAttr(this.el,"data-runningStatus","resumed")}_animIter(){this.el.dispatchEvent(new CustomEvent("finished"))}_repositionVert(){this._marqWrap.style.transfrom=`translateY(${"up"===this._opts.direction?this._contHeight:-1*this._elHeight}px)`}_repositionHor(){this._marqWrap.style.transfrom=`translateX(${"left"===this._opts.direction?this._contWidth:-1*this._elWidth}px)`}pause(){this._marqWrap.style.playState="paused",this._status="paused"}resume(){this._marqWrap.style.playState="running",this._status="running"}toggle(){"paused"===this._status?this.resume():"running"===this._status&&this.pause()}destroy(){this._opts.pauseOnHover&&(e(this.el,"mouseover",this.pause().bind(this)),e(this.el,"mouseout",this.resume().bind(this))),e(this._marqWrap,"animationiteration",this._animIter.bind(this),{once:!0}),e(this._marqWrap,"animationend",this._animEnd.bind(this),{once:!0})}}
